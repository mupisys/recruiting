{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Mupi Recruiting{% endblock %}</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="{% static 'js/tailwind-config.js' %}?v=2"></script>

  <!-- HTMX & Alpine -->
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  <script src="https://unpkg.com/alpinejs@3.13.3/dist/cdn.min.js" defer></script>
  
  <meta name="csrf-token" content="{{ csrf_token }}">
  <script src="{% static 'js/htmx-setup.js' %}?v=3"></script>

  <link rel="stylesheet" href="{% static 'css/styles.css' %}?v=27">

  {% block extra_head %}{% endblock %}
</head>
<body class="text-white font-sans antialiased min-h-screen flex flex-col"
      x-data="{ modalOpen: false }"
      @modal-open.window="modalOpen = true"
      @modal-close.window="modalOpen = false"
      @keydown.escape.window="modalOpen = false">

  <!-- Solid Background Layer -->
  <div class="fixed inset-0 bg-background pointer-events-none z-[-50]"></div>

  <!-- Background Effects: Top Spotlight (Timeless) -->
  <div class="fixed inset-0 pointer-events-none z-[-10]">
    <!-- Soft light emerging from the top center -->
    <div class="absolute inset-0 w-full h-full bg-spotlight"></div>
  </div>

  <div
    x-data="toastComponent()"
    x-init="{% for message in messages %}{% if forloop.last %}pushToast({ level: '{{ message.tags }}', message: '{{ message|escapejs }}' }){% endif %}{% endfor %}"
    @toast-add.window="pushToast($event.detail)"
    class="fixed inset-x-0 top-0 z-[70] flex justify-center pointer-events-none"
  >
    <div class="pointer-events-auto w-full max-w-md px-4 relative pt-safe-area">
      <div
        x-show="toast && toast.open"
        x-cloak
        x-transition:enter="transition ease-out duration-300 transform"
        x-transition:enter-start="opacity-0 -translate-y-2"
        x-transition:enter-end="opacity-100 translate-y-0"
        x-transition:leave="transition ease-in duration-200 transform"
        x-transition:leave-start="opacity-100 translate-y-0"
        x-transition:leave-end="opacity-0 -translate-y-2"
        class="w-full min-h-[64px] bg-surface border border-border rounded-2xl shadow-lg px-5 py-4 flex items-center gap-3 relative z-[1]"
      >
        <div
          class="shrink-0"
          :class="toast && (toast.level === 'success' ? 'text-accent-ice' : (toast.level === 'error' ? 'text-red-500' : (toast.level === 'warning' ? 'text-accent' : 'text-secondary')))"
        >
          <template x-if="toast && toast.level === 'success'">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M20 6 9 17l-5-5"/></svg>
          </template>
          <template x-if="toast && toast.level === 'error'">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86h3.42a2 2 0 0 1 1.73 1l7.25 12.56A2 2 0 0 1 20.96 20H3.04a2 2 0 0 1-1.73-3.58L8.56 4.86a2 2 0 0 1 1.73-1Z"/></svg>
          </template>
          <template x-if="toast && toast.level !== 'success' && toast.level !== 'error'">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
          </template>
        </div>

        <div class="flex-1 min-w-0">
          <p class="text-sm text-primary leading-snug break-words line-clamp-2" x-text="toast ? toast.message : ''"></p>
        </div>

        <button
          type="button"
          class="shrink-0 self-center text-secondary hover:text-primary transition-colors"
          @click="closeToast()"
          aria-label="Fechar"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg>
        </button>
      </div>
    </div>
  </div>

  {% block content %}{% endblock %}

  <!-- Global Modal -->
  <div id="modal-container" 
       x-show="modalOpen" 
       style="display: none;"
       class="fixed inset-0 z-50 overflow-y-auto" 
       aria-labelledby="modal-title" 
       role="dialog" 
       aria-modal="true">
       
    <!-- Backdrop -->
    <div x-show="modalOpen"
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-150"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 bg-black/40 backdrop-blur-md transition-opacity"></div>

    <!-- Panel Container -->
    <div class="flex min-h-full items-center justify-center p-4 text-center">
      <div x-show="modalOpen"
           @click.outside="modalOpen = false"
           id="modal-panel"
           x-transition:enter="transition ease-out-back duration-300 transform"
           x-transition:enter-start="opacity-0 scale-90 translate-y-4"
           x-transition:enter-end="opacity-100 scale-100 translate-y-0"
           x-transition:leave="transition ease-in-back duration-150 transform"
           x-transition:leave-start="opacity-100 scale-100 translate-y-0"
           x-transition:leave-end="opacity-0 scale-90 translate-y-4"
           class="relative w-full max-w-lg bg-surface border border-border rounded-3xl shadow-2xl overflow-hidden text-left align-middle transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)]">
           
        <div id="modal-content" 
             class="p-8 transition-opacity duration-200">
          <!-- Content injected via HTMX -->
        </div>
      </div>
    </div>
  </div>

  
  </body>
</html>
